
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Official Documentation of the Liquidart Project.">
      
      
      
        <meta name="author" content="Aldrin Mathew">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.2">
    
    
      
        <title>Tour - Liquidart Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f955dcd.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CFira+Code&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Fira Code"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="purple">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#liquidart-a-complete-tour" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Liquidart Documentation" class="md-header__button md-logo" aria-label="Liquidart Documentation" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Liquidart Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tour
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="purple" type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="purple" type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/aldrinsartfactory/liquidart/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Liquidart Documentation" class="md-nav__button md-logo" aria-label="Liquidart Documentation" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    Liquidart Documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/aldrinsartfactory/liquidart/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../core_concepts/" class="md-nav__link">
        Core Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Tour
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Tour
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#command-line-interface-cli" class="md-nav__link">
    Command-Line Interface (CLI)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initialization" class="md-nav__link">
    Initialization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#routing" class="md-nav__link">
    Routing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#controllers" class="md-nav__link">
    Controllers
  </a>
  
    <nav class="md-nav" aria-label="Controllers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resourcecontrollers" class="md-nav__link">
    ResourceControllers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#managedobjectcontrollers" class="md-nav__link">
    ManagedObjectControllers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Configuration
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-and-concurrency" class="md-nav__link">
    Running and Concurrency
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#postgresql-orm" class="md-nav__link">
    PostgreSQL ORM
  </a>
  
    <nav class="md-nav" aria-label="PostgreSQL ORM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defining-a-data-model" class="md-nav__link">
    Defining a Data Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database-migrations" class="md-nav__link">
    Database Migrations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oauth-20" class="md-nav__link">
    OAuth 2.0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    Logging
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    Testing
  </a>
  
    <nav class="md-nav" aria-label="Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#testing-with-a-database" class="md-nav__link">
    Testing with a Database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    Documentation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../best_practices/" class="md-nav__link">
        Best Practices
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../intellij/" class="md-nav__link">
        IntelliJ IDEA Templates
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Tutorial
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorial" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Tutorial
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/getting_started/" class="md-nav__link">
        1. Getting Started
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/executing_queries/" class="md-nav__link">
        2. Reading from a Database
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/storing_data/" class="md-nav__link">
        3. Storing Data in a Database
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/writing_tests/" class="md-nav__link">
        4. Configuration and Testing
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#command-line-interface-cli" class="md-nav__link">
    Command-Line Interface (CLI)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initialization" class="md-nav__link">
    Initialization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#routing" class="md-nav__link">
    Routing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#controllers" class="md-nav__link">
    Controllers
  </a>
  
    <nav class="md-nav" aria-label="Controllers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resourcecontrollers" class="md-nav__link">
    ResourceControllers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#managedobjectcontrollers" class="md-nav__link">
    ManagedObjectControllers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Configuration
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-and-concurrency" class="md-nav__link">
    Running and Concurrency
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#postgresql-orm" class="md-nav__link">
    PostgreSQL ORM
  </a>
  
    <nav class="md-nav" aria-label="PostgreSQL ORM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defining-a-data-model" class="md-nav__link">
    Defining a Data Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database-migrations" class="md-nav__link">
    Database Migrations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oauth-20" class="md-nav__link">
    OAuth 2.0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    Logging
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    Testing
  </a>
  
    <nav class="md-nav" aria-label="Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#testing-with-a-database" class="md-nav__link">
    Testing with a Database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    Documentation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/aldrinsartfactory/liquidart/edit/master/docs/tour.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="liquidart-a-complete-tour">Liquidart: A Complete Tour</h1>
<p>The tour demonstrates many of Liquidart's features.</p>
<h2 id="command-line-interface-cli">Command-Line Interface (CLI)</h2>
<p>The <code>liquidart</code> command line tool creates, runs and documents Liquidart applications; manages database migrations; and manages OAuth client identifiers. Install by running <code>pub global activate liquidart</code> on a machine with Dart installed.</p>
<p>Create and run an application:</p>
<pre><code>liquidart create my_app
cd my_app/
liquidart serve
</code></pre>
<h2 id="initialization">Initialization</h2>
<p>An Liquidart application starts at an <a href="https://aldrinsartfactory.github.io/liquidart/application/channel/">ApplicationChannel</a>. You subclass it once per application to handle initialization tasks like setting up routes and database connections. An example application looks like this:</p>
<pre><code class="language-dart">import 'package:liquidart/liquidart.dart';

class TodoApp extends ApplicationChannel {
  ManagedContext context;

  @override
  Future prepare() async {
    context = ManagedContext(...);
  }

  @override
  Controller get entryPoint {
    final router = Router();

    router
      .route(&quot;/projects/[:id]&quot;)
      .link(() =&gt; ProjectController(context));

    return router;
  }
}
</code></pre>
<h2 id="routing">Routing</h2>
<p>A <a href="https://aldrinsartfactory.github.io/liquidart/http/routing/">router</a> determines which controller object should handle a request. The route specification syntax is a concise syntax to construct routes with variables and optional segments in a single statement.</p>
<pre><code class="language-dart">@override
Controller get entryPoint {
  final router = Router();

  // Handles /users, /users/1, /users/2, etc.
  router
    .route(&quot;/projects/[:id]&quot;)
    .link(() =&gt; ProjectController());

  // Handles any route that starts with /file/
  router
    .route(&quot;/file/*&quot;)
    .link(() =&gt; FileController());

  // Handles the specific route /health
  router
    .route(&quot;/health&quot;)
    .linkFunction((req) async =&gt; Response.ok(null));

  return router;
}
</code></pre>
<h2 id="controllers">Controllers</h2>
<p><a href="https://aldrinsartfactory.github.io/liquidart/http/controller/">Controllers</a> handle requests. A controller handles a request by overriding its handle method. This method either returns a response or a request. If a response is returned, that response is sent to the client. If the request is returned, the linked controller handles the request.</p>
<pre><code class="language-dart">class SecretKeyAuthorizer extends Controller {
  @override
  Future&lt;RequestOrResponse&gt; handle(Request request) async {
    if (request.raw.headers.value(&quot;x-secret-key&quot;) == &quot;secret!&quot;) {
      return request;
    }

    return Response.badRequest();
  }
}
</code></pre>
<p>This behavior allows for middleware controllers to be linked together, such that a request goes through a number of steps before it is finally handled.</p>
<p>All controllers execute their code in an exception handler. If an exception is thrown in your controller code, a response with an appropriate error code is returned. You subclass <code>HandlerException</code> to provide error response customization for application-specific exceptions.</p>
<h3 id="resourcecontrollers">ResourceControllers</h3>
<p><a href="https://aldrinsartfactory.github.io/liquidart/http/resource_controller/">ResourceControllers</a> are the most often used controller. Each operation - e.g. <code>POST /projects</code>, <code>GET /projects</code> and <code>GET /projects/1</code> - is mapped to methods in a subclass. Parameters of those methods are annotated to bind the values of the request when the method is invoked.</p>
<pre><code class="language-dart">import 'package:liquidart/liquidart.dart'

class ProjectController extends ResourceController {    
  @Operation.get('id')
  Future&lt;Response&gt; getProjectById(@Bind.path(&quot;id&quot;) int id) async {
    // GET /projects/:id
    return Response.ok(...);
  }

  @Operation.post()
  Future&lt;Response&gt; createProject(@Bind.body() Project project) async {
    // POST /project
    final inserted = await insertProject(project);
    return Response.ok(inserted);
  }

  @Operation.get()
  Future&lt;Response&gt; getAllProjects(
    @Bind.header(&quot;x-client-id&quot;) String clientId,
    {@Bind.query(&quot;limit&quot;) int limit: 10}) async {
    // GET /projects
    return Response.ok(...);
  }
}
</code></pre>
<h3 id="managedobjectcontrollers">ManagedObjectControllers</h3>
<p><code>ManagedObjectController&lt;T&gt;</code>s are ResourceControllers that automatically map a REST interface to database queries; e.g. POST inserts a row, GET gets all row of a type. They do not need to be subclassed, but can be to provide customization.</p>
<pre><code class="language-dart">router
  .route(&quot;/users/[:id]&quot;)
  .link(() =&gt; ManagedObjectController&lt;Project&gt;(context));
</code></pre>
<h2 id="configuration">Configuration</h2>
<p>An application's configuration is written in a YAML file. Each environment your application runs in (e.g., locally, under test, production, development) has different values for things like the port to listen on and database connection credentials. The format of a configuration file is defined by your application. An example looks like:</p>
<pre><code>// config.yaml
database:
  host: api.projects.com
  port: 5432
  databaseName: project
port: 8000
</code></pre>
<p>Subclass Configuration and declare a property for each key in your configuration file:</p>
<pre><code>class TodoConfig extends Configuration {
  TodoConfig(String path) : super.fromFile(File(path));

  DatabaseConfiguration database;
  int port;
}
</code></pre>
<p>The default name of your configuration file is <code>config.yaml</code>, but can be changed at the command-line. You create an instance of your configuration from the configuration file path from your application options:</p>
<pre><code>import 'package:liquidart/liquidart.dart';

class TodoApp extends ApplicationChannel {
  @override
  Future prepare() async {
    var options = TodoConfig(options.configurationFilePath);
    ...
  }
}
</code></pre>
<h3 id="running-and-concurrency">Running and Concurrency</h3>
<p>Liquidart applications are run with the <code>liquidart serve</code> command line tool. You can attach debugging and instrumentation tools and specify how many threads the application should run on:</p>
<pre><code>liquidart serve --observe --isolates 5 --port 8888
</code></pre>
<p>Liquidart applications are multi-isolate (multi-threaded). Each isolate runs a replica of the same web server with its own set of services like database connections. This makes behavior like database connection pooling implicit.</p>
<h2 id="postgresql-orm">PostgreSQL ORM</h2>
<p>The <code>Query&lt;T&gt;</code> class configures and executes database queries. Its type argument determines what table is to be queried and the type of object you will work with in your code.</p>
<pre><code class="language-dart">import 'package:liquidart/liquidart.dart'

class ProjectController extends ResourceController {
  ProjectController(this.context);

  final ManagedContext context;

  @Operation.get()
  Future&lt;Response&gt; getAllProjects() async {
    final query = Query&lt;Project&gt;(context);

    final results = await query.fetch();

    return Response.ok(results);
  }
}
</code></pre>
<p>Configuration of the query - like its <code>WHERE</code> clause - are configured through a fluent, type-safe syntax. A property selector identifies which column of the table to apply an expression to. The following query fetches all project's due in the next week and includes their tasks by joining the related table.</p>
<pre><code class="language-dart">final nextWeek = DateTime.now().add(Duration(days: 7));
final query = Query&lt;Project&gt;(context)
  ..where((project) =&gt; project.dueDate).isLessThan(nextWeek)
  ..join(set: (project) =&gt; project.tasks);
final projects = await query.fetch();
</code></pre>
<p>Rows are inserted or updated by setting the statically-typed values of a query.</p>
<pre><code class="language-dart">final insertQuery = Query&lt;Project&gt;(context)
  ..values.name = &quot;Build an liquidart&quot;
  ..values.dueDate = DateTime(year, month);
var newProject = await insertQuery.insert();  

final updateQuery = Query&lt;Project&gt;(context)
  ..where((project) =&gt; project.id).equalTo(newProject.id)
  ..values.name = &quot;Build a miniature liquidart&quot;;
newProject = await updateQuery.updateOne();
</code></pre>
<p><code>Query&lt;T&gt;</code>s can perform sorting, joining and paging queries.</p>
<pre><code class="language-dart">final overdueQuery = Query&lt;Project&gt;(context)
  ..where((project) =&gt; project.dueDate).lessThan(DateTime().now())
  ..sortBy((project) =&gt; project.dueDate, QuerySortOrder.ascending)
  ..join(object: (project) =&gt; project.owner);

final overdueProjectsAndTheirOwners = await query.fetch();
</code></pre>
<p>Controllers will interpret exceptions thrown by queries to return an appropriate error response to the client. For example, unique constraint conflicts return 409, missing required properties return 400 and database connection failure returns 503.</p>
<h3 id="defining-a-data-model">Defining a Data Model</h3>
<p>To use the ORM, you declare your tables as Dart types and create a subclass of <code>ManagedObject&lt;T&gt;</code>. A subclass maps to a table in the database, each instance maps to a row, and each property is a column. The following declaration will map to a table named <code>_project</code> with columns <code>id</code>, <code>name</code> and <code>dueDate</code>.</p>
<pre><code class="language-dart">class Project extends ManagedObject&lt;_Project&gt; implements _Project {
  bool get isPastDue =&gt; dueDate.difference(DateTime.now()).inSeconds &lt; 0;
}

class _Project  {
  @primaryKey
  int id;

  @Column(indexed: true)
  String name;

  DateTime dueDate;
}
</code></pre>
<p>Managed objects have relationships to other managed objects. Relationships can be has-one, has-many and many-to-many. A relationship is always two-sided - the related types must declare a property that references each other.</p>
<pre><code class="language-dart">class Project extends ManagedObject&lt;_Project&gt; implements _Project {}
class _Project {
  ...

  // Project has-many Tasks
  ManagedSet&lt;Task&gt; tasks;
}

class Task extends ManagedObject&lt;_Task&gt; implements _Task {}
class _Task {
  ...

  // Task belongs to a project, maps to 'project_id' foreign key column
  @Relate(#tasks)
  Project project;
}
</code></pre>
<p><code>ManagedObject&lt;T&gt;</code>s are serializable and can be directly read from a request body, or encoded as a response body.</p>
<pre><code class="language-dart">class ProjectController extends ResourceController {
  @Operation.put('id')
  Future&lt;Response&gt; updateProject(@Bind.path('id') int projectId, @Bind.body() Project project) async {
    final query = Query&lt;Project&gt;(context)
      ..where((project) =&gt; project.id).equalTo(projectId)
      ..values = project;

    return Response.ok(await query.updateOne());
  }
}
</code></pre>
<h3 id="database-migrations">Database Migrations</h3>
<p>The CLI will automatically generate database migration scripts by detecting changes to your managed objects. The following, when ran in a project directory, will generate and execute a database migration.</p>
<pre><code>liquidart db generate
liquidart db upgrade --connect postgres://user:password@host:5432/database
</code></pre>
<p>You can edit migration files by hand to alter any assumptions or enter required values, and run <strong><code>liquidart db validate</code></strong> to ensure the changes still yield the same schema. Be sure to keep generated files in version control.</p>
<h2 id="oauth-20">OAuth 2.0</h2>
<p>An OAuth 2.0 server implementation handles authentication and authorization for Liquidart applications. You create an <code>AuthServer</code> and its delegate as services in your application. The delegate is configurable and manages how tokens are generated and stored. By default, access tokens are a random 32-byte string and client identifiers, tokens and access codes are stored in your database using the ORM.</p>
<pre><code class="language-dart">import 'package:liquidart/liquidart.dart';
import 'package:liquidart/managed_auth.dart';

class AppApplicationChannel extends ApplicationChannel {
  AuthServer authServer;
  ManagedContext context;

  @override
  Future prepare() async {
    context = ManagedContext(...);

    final delegate = ManagedAuthDelegate&lt;User&gt;(context);
    authServer = AuthServer(delegate);
  }  
}
</code></pre>
<p>Built-in authentication controllers for exchanging user credentials for access tokens are named <code>AuthController</code> and <code>AuthCodeController</code>. <code>Authorizer</code>s are middleware that require a valid access token to access their linked controller.</p>
<pre><code class="language-dart">Controller get entryPoint {
  final router = Router();

  // POST /auth/token with username and password (or access code) to get access token
  router
    .route(&quot;/auth/token&quot;)
    .link(() =&gt; AuthController(authServer));

  // GET /auth/code returns login form, POST /auth/code grants access code
  router
    .route(&quot;/auth/code&quot;)
    .link(() =&gt; AuthCodeController(authServer));

  // ProjectController requires request to include access token
  router
    .route(&quot;/projects/[:id]&quot;)
    .link(() =&gt; Authorizer.bearer(authServer))
    .link(() =&gt; ProjectController(context));

  return router;
}
</code></pre>
<p>The CLI has tools to manage OAuth 2.0 client identifiers and access scopes.</p>
<pre><code>liquidart auth add-client \
  --id com.app.mobile \
  --secret foobar \
  --redirect-uri https://somewhereoutthere.com \
  --allowed-scopes &quot;users projects admin.readonly&quot;
</code></pre>
<h2 id="logging">Logging</h2>
<p>All requests are logged to an application-wide logger. Set up a listener for the logger in <code>ApplicationChannel</code> to write log messages to the console or another medium.</p>
<pre><code>class WildfireChannel extends ApplicationChannel {
  @override
  Future prepare() async {
    logger.onRecord.listen((record) {
      print(&quot;$record&quot;);
    });
  }
}
</code></pre>
<h2 id="testing">Testing</h2>
<p>Liquidart tests start a local version of your application and execute requests. You write expectations on the responses. A <a href="https://aldrinsartfactory.github.io/liquidart/testing/tests/">TestHarness</a> manages the starting and stopping of an application, and exposes a default <code>Agent</code> for executing requests. An <code>Agent</code> can be configured to have default headers, and multiple agents can be used within the same test.</p>
<pre><code class="language-dart">import 'harness/app.dart';

void main() {
  final harness = TestHarness&lt;TodoApp&gt;()..install();

  test(&quot;GET /projects returns all projects&quot; , () async {
    var response = await harness.agent.get(&quot;/projects&quot;);
    expectResponse(response, 200, body: every(partial({
      &quot;id&quot;: greaterThan(0),
      &quot;name&quot;: isNotNull,
      &quot;dueDate&quot;: isNotNull
    })));
  });
}
</code></pre>
<h3 id="testing-with-a-database">Testing with a Database</h3>
<p>Liquidart's ORM uses PostgreSQL as its database. Before your tests run, Liquidart will create your application's database tables in a local PostgreSQL database. After the tests complete, it will delete those tables. This allows you to start with an empty database for each test suite as well as control exactly which records are in your database while testing, but without having to manage database schemas or use an mock implementation (e.g., SQLite).</p>
<p>This behavior, and behavior for managing applications with an OAuth 2.0 provider, are available as <a href="https://aldrinsartfactory.github.io/liquidart/testing/mixins/">harness mixins</a>.</p>
<h3 id="documentation">Documentation</h3>
<p>OpenAPI documents describe your application's interface. These documents can be used to generate documentation and client code. A document can be generated by reflecting on your application's codebase, just run the <code>liquidart document</code> command.</p>
<p>The <code>liquidart document client</code> command creates a web page that can be used to configure issue requests specific to your application.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../getting_started/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Getting Started
            </div>
          </div>
        </a>
      
      
        <a href="../best_practices/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Best Practices
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Original documentation of Liquidart (previously Aqueduct) written by the StableKernel Team
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.4ea5477f.min.js"></script>
      
    
  </body>
</html>